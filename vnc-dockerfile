FROM centos/systemd

MAINTAINER "Your Name" <you@example.com>
#docker run --privileged -v /sys/fs/cgroup:/sys/fs/cgroup:ro -p 5901:5901 -d di
#docker build --rm --no-cache -t di .

RUN yum -y install cabextract bind-utils traceroute net-tools bash-completion tigervnc-server vim git wget epel-release python2-pip
RUN yum -y group install GNOME Desktop

# install config vnc
RUN systemctl stop firewalld.service; \
    systemctl disable firewalld.service; \
    cp /lib/systemd/system/vncserver@.service /etc/systemd/system/vncserver@:1.service; \
    sed -e 's|<USER>|root|' -e 's|/home||' -i /etc/systemd/system/vncserver@:1.service; \
    systemctl daemon-reload; systemctl enable vncserver@:1.service; \
    echo -e "111111\n111111\nn\n" | vncpasswd

RUN yum clean all
RUN sed  -e "/^ExecStartPre.*/aExecStartPre=/bin/sh -c 'rm -fr /root/.vnc/*.pid /tmp/.X11-unix/*; /usr/bin/vncserver -kill %i > /dev/null 2>&1 || :'"   -e '/^ExecStartPre.*/d' -i /etc/systemd/system/vncserver@\:1.service

CMD ["/usr/sbin/init"]
